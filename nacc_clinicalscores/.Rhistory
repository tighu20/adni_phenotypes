library(dplyr)
library(stringr)
library(ggplot2)
library(DT)
library(brms)
# import clinical scores
clinical_data_file = "../data/nacc_collatedResults.csv"
clindata = read.table(clinical_data_file, header = TRUE)
# remove volume and thickness measures
clindata <- clindata %>%
select(colnames(.)[!grepl("volume", colnames(.))]) %>%
select(colnames(.)[!grepl("thickness", colnames(.))])
# import results
# the '50' is the dropout results
results_file = "../results/latest_output_nacc_50.csv"
results = read.table(results_file, header = TRUE, sep = ",")
results <- results %>%
mutate(subj = paste("sub-NACC", str_pad(nacc_id, width=6, side="left", pad="0"), sep = "")) %>%
select(-nacc_id)
# diagnosis groups
diagnosis_map = list('Alzheimer’s disease (AD)' = 'AD',
'Vascular brain injury or vascular dementia including stroke' = 'OD',
'Lewy body disease (LBD)' = 'OD',
'Control' = 'Control',
'Depression' = 'OND',
'Missing/unknown' = 'remove', ## <<---------- !
'Other neurologic, genetic, or infectious condition' = 'OND',
'Cognitive impairment for other specified reasons (i.e., written-in values)' = 'OND',
'Prion disease (CJD, other)' = 'OD',
'FTLD, other' = 'OD',
'Anxiety disorder' = 'OND',
'Corticobasal degeneration (CBD)' = 'OD',
'Cognitive impairment due to medications' = 'OND',
'Other psychiatric disease' = 'OND',
'Progressive supranuclear palsy (PSP)' = 'OD',
'Cognitive impairment due to systemic disease or medical illness' = 'OND',
'Traumatic brain injury (TBI)' = 'OND',
'Cognitive impairment due to alcohol abuse' = 'OND',
'Bipolar disorder' = 'OND',
'Schizophrenia or other psychosis' = 'OND',
'FTLD with motor neuron disease (e.g., ALS)' = 'OD')
results <- results %>%
left_join(clindata, by = "subj") %>%
mutate(diagnosis = diagnosis_map[diagnosis]) %>%
filter(diagnosis != "remove")
results$diagnosis <- factor(unlist(results$diagnosis),
levels = c("Control", "AD", "OD", "OND"))
rm(clindata)
naccmmse <- results %>%
filter(!is.na(nacmmse))
naccmmse_summary <- naccmmse %>%
group_by(diagnosis) %>%
summarise(n = length(subj),
age = round(mean(age, na.rm = TRUE), digits = 1),
sex = paste(length(gender[gender == "Female"]),
length(gender[gender == "Male"]),
sep = "/"))
datatable(naccmmse_summary)
p_mmse <- ggplot(naccmmse, aes(x = mean, y = nacmmse, group = diagnosis, colour = diagnosis))
p_mmse <- p_mmse + geom_point() + geom_smooth(method = lm)
print(p_mmse)
anova_mmse <- brm(nacmmse ~ mean * diagnosis,
data = naccmmse,
prior = c(set_prior("cauchy(0,5)", class = "b")),
family = cumulative())
min(naccmmse$nacmmse)
naccmmse <- naccmmse %>%
mutate(nacmmse = nacmmse + 1)
anova_mmse <- brm(nacmmse ~ mean * diagnosis,
data = naccmmse,
prior = c(set_prior("cauchy(0,5)", class = "b")),
family = )
naccmmse <- naccmmse %>%
mutate(nacmmse <- nacmmse + 1)
library(dplyr)
library(stringr)
library(ggplot2)
library(DT)
library(brms)
# import clinical scores
clinical_data_file = "../data/nacc_collatedResults.csv"
clindata = read.table(clinical_data_file, header = TRUE)
# remove volume and thickness measures
clindata <- clindata %>%
select(colnames(.)[!grepl("volume", colnames(.))]) %>%
select(colnames(.)[!grepl("thickness", colnames(.))])
# import results
# the '50' is the dropout results
results_file = "../results/latest_output_nacc_50.csv"
results = read.table(results_file, header = TRUE, sep = ",")
results <- results %>%
mutate(subj = paste("sub-NACC", str_pad(nacc_id, width=6, side="left", pad="0"), sep = "")) %>%
select(-nacc_id)
# diagnosis groups
diagnosis_map = list('Alzheimer’s disease (AD)' = 'AD',
'Vascular brain injury or vascular dementia including stroke' = 'OD',
'Lewy body disease (LBD)' = 'OD',
'Control' = 'Control',
'Depression' = 'OND',
'Missing/unknown' = 'remove', ## <<---------- !
'Other neurologic, genetic, or infectious condition' = 'OND',
'Cognitive impairment for other specified reasons (i.e., written-in values)' = 'OND',
'Prion disease (CJD, other)' = 'OD',
'FTLD, other' = 'OD',
'Anxiety disorder' = 'OND',
'Corticobasal degeneration (CBD)' = 'OD',
'Cognitive impairment due to medications' = 'OND',
'Other psychiatric disease' = 'OND',
'Progressive supranuclear palsy (PSP)' = 'OD',
'Cognitive impairment due to systemic disease or medical illness' = 'OND',
'Traumatic brain injury (TBI)' = 'OND',
'Cognitive impairment due to alcohol abuse' = 'OND',
'Bipolar disorder' = 'OND',
'Schizophrenia or other psychosis' = 'OND',
'FTLD with motor neuron disease (e.g., ALS)' = 'OD')
results <- results %>%
left_join(clindata, by = "subj") %>%
mutate(diagnosis = diagnosis_map[diagnosis]) %>%
filter(diagnosis != "remove")
results$diagnosis <- factor(unlist(results$diagnosis),
levels = c("Control", "AD", "OD", "OND"))
rm(clindata)
naccmmse <- results %>%
filter(!is.na(nacmmse))
naccmmse_summary <- naccmmse %>%
group_by(diagnosis) %>%
summarise(n = length(subj),
age = round(mean(age, na.rm = TRUE), digits = 1),
sex = paste(length(gender[gender == "Female"]),
length(gender[gender == "Male"]),
sep = "/"))
datatable(naccmmse_summary)
p_mmse <- ggplot(naccmmse, aes(x = mean, y = nacmmse, group = diagnosis, colour = diagnosis))
p_mmse <- p_mmse + geom_point() + geom_smooth(method = lm)
print(p_mmse)
naccmmse <- naccmmse %>%
mutate(nacmmse <- nacmmse + 1)
anova_mmse <- brm(nacmmse ~ mean * diagnosis,
data = naccmmse,
prior = c(set_prior("cauchy(0,5)", class = "b")),
family = "cumulative")
anova_mmse <- brm(nacmmse ~ mean * diagnosis,
data = naccmmse,
prior = c(set_prior("cauchy(0,5)", class = "b")),
family = "cumulative")
anova_mmse <- brm(nacmmse ~ mean * diagnosis,
data = naccmmse,
prior = c(set_prior("cauchy(0,5)", class = "b")),
family = "skew_normal")
summary(anova_mmse)
plot(anova_mmse)
